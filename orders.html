<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Vasansi Enterprise Application ‚Äî Orders</title>
<link rel="stylesheet" href="assets/style.css">
<style>
  /* Keep your existing table look inside the card */
  #dataTable { width:100%; border-collapse:collapse; background:#fff; }
  #dataTable th, #dataTable td { border:1px solid #e3e3e3; padding:6px 8px; font-size:13px; white-space:nowrap; }
  #dataTable th { background:#f5f6f7; }
  img { width: 100px; height: 150px; object-fit: cover; border-radius: 5px; }
  .remark-cell { white-space: normal; max-width: 400px; min-width: 150px; }
  .save-btn { background:#28a745; color:#fff; padding:5px 10px; border:none; border-radius:4px; cursor:pointer; }
  .pagination button { margin:0 2px; padding:5px 10px; border:1px solid #007bff; border-radius:4px; background:#fff; color:#007bff; cursor:pointer; }
  .pagination button.active { background:#007bff; color:#fff; }
  .pagination button[disabled] { opacity:.4; cursor:not-allowed; }
  #entriesSelect { border:1px solid #ccc; border-radius:4px; padding:4px 6px; margin:0 4px; }
  .status-checkboxes { display:flex; flex-wrap:wrap; gap:8px; }
</style>
</head>
<body>
<div class="app">
  <div class="topbar">
    <div class="title">Vasansi Enterprise Application</div>
    <div class="user">Hemant Solanki ‚ñº</div>
  </div>

    <aside class="sidebar">
    <ul class="nav">
      <li><a href="index.html">üè† <span class="label">Dashboard</span></a></li>
      <li><a href="dispatch.html">üì¶ <span class="label">Dispatch</span></a></li>
      <li><a href="jobwork.html">üßµ <span class="label">Job Work</span></a></li>
      <li class="section-title">Order</li>
      <li>
        <a href="orders.html">üìã <span class="label">All Orders</span></a>
        <ul class="submenu">
          <li><a href="orders.html#Branch%20Sales%20Order">Branch Sales Order</a></li>
          <li><a href="orders.html#Jaipur%20Sales%20Order">Jaipur Sales Order</a></li>
          <li><a href="orders.html#Jaipur%20Alterations">Jaipur Alterations</a></li>
          <li><a href="orders.html#Exhibition%20Sales%20Order">Exhibition Sales Order</a></li>
          <li><a href="orders.html#Wholesale%20Order">Wholesale Order</a></li>
        </ul>
      </li>
      <li><a href="production.html">üè≠ <span class="label">Production</span></a></li>
      <li><a href="reports.html">üìë <span class="label">Reports</span></a></li>
    </ul>
  </aside>

  <!-- Content -->
  <main class="content">
    <div class="card">
      <h2>Online Orders List</h2>
      <div class="controls">
        <label>Order No <input type="text" id="filterOrderNo" placeholder="Enter order no..."></label>
        <label>Order Date <input type="date" id="filterOrderStart"> to <input type="date" id="filterOrderEnd"></label>
        <label>Delivery Date <input type="date" id="filterDeliveryStart"> to <input type="date" id="filterDeliveryEnd"></label>
        <label>Unit <select id="filterUnit"></select></label>
        <label>Sheet <select id="filterSheet"></select></label>
        <button class="btn" onclick="applyFilters()">Search</button>
        <button onclick="resetFilters()">Reset</button>
      </div>

      <div class="controls">
        <label><strong>Status:</strong></label>
        <div class="status-checkboxes" id="statusCheckboxes"></div>
      </div>

      <div class="controls" style="justify-content: space-between;">
        <input type="text" id="searchBar" placeholder="üîç Search..." oninput="searchTable()">
        <label>Show
          <select id="entriesSelect" onchange="changeEntries()">
            <option value="10">10</option>
            <option value="25" selected>25</option>
            <option value="50">50</option>
            <option value="100">100</option>
          </select> entries
        </label>
      </div>

      <table id="dataTable"></table>
      <div class="pagination" id="pagination"></div>
    </div>
  </main>
</div>

<script src="assets/app.js"></script>
<script>
const SCRIPT_URL =
  "https://script.google.com/macros/s/AKfycbyE5VORxmizRnO1Cnw0LVZjbl_f_ZBOgadrGynkJLfsl5QPs1ocPhDkOqpi_jH1tTZt/exec";

const SHEETS = [
  "Branch Sales Order","Jaipur Sales Order","Jaipur Alterations",
  "Exhibition Sales Order","Wholesale Order"
];

function clean(arr){
  return Array.isArray(arr)
    ? arr.filter(r=>Array.isArray(r)).map(r=>r.map(c=>c==null?"":String(c)))
    : [];
}

async function loadData(){
  const tbl=document.getElementById("dataTable");
  tbl.innerHTML="<tr><td>Loading‚Ä¶</td></tr>";
  try{
    const res=await fetch(`${SCRIPT_URL}?t=${Date.now()}`);
    const json=await res.json();
    console.log("‚úÖ Received keys:", Object.keys(json));

    let rows=[];
    SHEETS.forEach(s=>{
      const d=json[s];
      if(!Array.isArray(d)||d.length<2) return;
      const headers=d[0];
      d.slice(1).forEach(r=>{
        const obj={};
        headers.forEach((h,i)=>obj[h]=r[i]||"");
        obj.SheetName=s;
        rows.push(obj);
      });
    });

    if(!rows.length){
      tbl.innerHTML="<tr><td>No rows found</td></tr>";
      return;
    }

    // headers
    const cols=Object.keys(rows[0]);
    let html="<thead><tr>"+cols.map(c=>`<th>${c}</th>`).join("")+"</tr></thead><tbody>";
    rows.forEach(r=>{
      html+="<tr>"+cols.map(c=>`<td>${r[c]}</td>`).join("")+"</tr>";
    });
    html+="</tbody>";
    tbl.innerHTML=html;
  }catch(e){
    console.error(e);
    tbl.innerHTML=`<tr><td style='color:red'>‚ùå ${e.message}</td></tr>`;
  }
}
loadData();
</script>

</script>
</body>
</html>
