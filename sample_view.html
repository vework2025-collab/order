<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sample View</title>
<style>
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: #f8faff;
    margin: 0;
    padding: 20px;
  }

  h1 {
    color: #0a53be;
    font-size: 28px;
    margin-bottom: 20px;
  }

  .filter-bar {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
  }

  select, input {
    padding: 8px 10px;
    border: 1px solid #d0d7e2;
    border-radius: 6px;
    background: #fff;
    font-size: 14px;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    transition: all 0.2s;
  }
  select:hover, input:hover {
    border-color: #0a53be;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    background: #fff;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  }

  th {
    background: #0a53be;
    color: #fff;
    padding: 12px 10px;
    font-weight: 600;
    text-align: left;
  }

  td {
    padding: 10px;
    border-bottom: 1px solid #f0f2f5;
  }

  tr:hover {
    background-color: #f3f7ff;
  }

  img.thumb {
    width: 70px;
    height: 70px;
    border-radius: 6px;
    object-fit: cover;
    transition: transform 0.2s;
    cursor: pointer;
  }

  img.thumb:hover {
    transform: scale(1.15);
  }

  @media (max-width: 768px) {
    th, td { font-size: 12px; padding: 8px; }
    img.thumb { width: 50px; height: 50px; }
  }
</style>

</head>
<body>
<h1>Sample View</h1>

<div class="filter-bar">
  <select id="designerFilter"><option value="">All Designers</option></select>
  <select id="unitFilter"><option value="">All Units</option></select>
  <select id="productFilter"><option value="">All Products</option></select>
  <select id="styleIdFilter"><option value="">All Style IDs</option></select>
  <select id="styleNoFilter"><option value="">All Style Nos</option></select>
  <input type="text" id="searchBox" placeholder="Search Design No...">
</div>

<table id="samplesTable">
  <thead>
    <tr>
      <th>Sr No</th>
      <th>Designer Name</th>
      <th>Unit</th>
      <th>Product Name</th>
      <th>Print Style ID</th>
      <th>Print Style No</th>
      <th>Design No</th>
      <th>Product Image (Front)</th>
      <th>Product Image (Back)</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby-dpjTO3lDKPC9lHXjz4zQN3Cl7uoafvcocQDaWDmHurmxsAZrhszC3bj3rbXmdkcr/exec";

let allData = [];

async function loadSamples() {
  const res = await fetch(`${SCRIPT_URL}?action=getSamplesData`);
  const data = await res.json();
  allData = data;
  populateFilters(data);
  renderTable(data);
}

function populateFilters(data) {
  const unique = (key) => [...new Set(data.map(d => d[key]).filter(Boolean))];
  const setOptions = (id, values) => {
    const el = document.getElementById(id);
    el.innerHTML = `<option value="">All</option>` + values.map(v => `<option>${v}</option>`).join("");
  };
  setOptions("designerFilter", unique("designerName"));
  setOptions("unitFilter", unique("unit"));
  setOptions("productFilter", unique("productName"));
  setOptions("styleIdFilter", unique("printStyleId"));
  setOptions("styleNoFilter", unique("printStyleNo"));
}

function renderTable(data) {
  const tbody = document.querySelector("#samplesTable tbody");
  tbody.innerHTML = "";
  data.forEach(row => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${row.srNo}</td>
      <td>${row.designerName || ""}</td>
      <td>${row.unit || ""}</td>
      <td>${row.productName || ""}</td>
      <td>${row.printStyleId || ""}</td>
      <td>${row.printStyleNo || ""}</td>
      <td>${row.designNo || ""}</td>
      <td>${row.imageFront ? `<a href="${row.imageFront}" target="_blank"><img class="thumb" src="${row.imageFront}"></a>` : ""}</td>
      <td>${row.imageBack ? `<a href="${row.imageBack}" target="_blank"><img class="thumb" src="${row.imageBack}"></a>` : ""}</td>
    `;
    tbody.appendChild(tr);
  });
}

function applyFilters() {
  let filtered = [...allData];
  const dF = document.getElementById("designerFilter").value;
  const uF = document.getElementById("unitFilter").value;
  const pF = document.getElementById("productFilter").value;
  const idF = document.getElementById("styleIdFilter").value;
  const noF = document.getElementById("styleNoFilter").value;
  const search = document.getElementById("searchBox").value.toLowerCase();

  if (dF) filtered = filtered.filter(d => d.designerName === dF);
  if (uF) filtered = filtered.filter(d => d.unit === uF);
  if (pF) filtered = filtered.filter(d => d.productName === pF);
  if (idF) filtered = filtered.filter(d => d.printStyleId === idF);
  if (noF) filtered = filtered.filter(d => d.printStyleNo === noF);
  if (search) filtered = filtered.filter(d => (d.designNo || "").toLowerCase().includes(search));

  renderTable(filtered);
}

document.querySelectorAll(".filter-bar select, #searchBox").forEach(el => {
  el.addEventListener("change", applyFilters);
  el.addEventListener("keyup", applyFilters);
});

loadSamples();
</script>
</body>
</html>
